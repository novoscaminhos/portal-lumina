<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Lumina ‚Äî Chave de Acesso</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/x-icon" href="./assets/favicon.ico">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      background: radial-gradient(circle at center, #0f172a, #020617);
    }
  </style>
</head>

<body class="min-h-screen flex items-center justify-center text-slate-200">

  <div class="max-w-md w-full bg-slate-900/90 backdrop-blur rounded-2xl shadow-2xl p-8">

    <!-- LOGO -->
    <div class="flex justify-center mb-6">
      <img src="./assets/LOGO.png" alt="Lumina" class="h-16">
    </div>

    <h1 class="text-center text-lg font-semibold tracking-widest mb-2">
      ACESSO RESTRITO
    </h1>

    <p class="text-center text-sm text-slate-400 mb-6">
      Insira sua chave ritual para atravessar o portal
    </p>

    <!-- INPUT -->
    <input
      id="tokenInput"
      type="text"
      placeholder="LUMINA-XXXX-XXXX"
      class="w-full px-4 py-3 mb-4 rounded-lg bg-slate-800 border border-slate-600 text-center tracking-widest uppercase focus:outline-none focus:ring-2 focus:ring-indigo-500"
    />

    <!-- BOT√ÉO -->
    <button
      onclick="validarChave()"
      class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-lg font-semibold tracking-wider transition"
    >
      VALIDAR CHAVE
    </button>

    <!-- ERRO -->
    <p id="erro" class="text-red-400 text-sm mt-4 hidden text-center">
      Chave inv√°lida ou n√£o reconhecida.
    </p>

    <!-- VOLTAR -->
    <div class="mt-6 text-center text-xs text-slate-400">
      <a href="./index.html" class="hover:underline">‚Üê Voltar ao portal</a>
    </div>

  </div>

<script>
async function validarChave() {
  const input = document.getElementById('tokenInput');
  const erro = document.getElementById('erro');

  const token = input.value.trim().toUpperCase();
  erro.classList.add('hidden');

  if (!token) {
    erro.innerText = 'Informe uma chave v√°lida.';
    erro.classList.remove('hidden');
    return;
  }

  try {
    const res = await fetch('./tokens.json');
    const tokens = await res.json();

    if (!tokens[token]) {
      erro.innerText = 'Chave n√£o reconhecida.';
      erro.classList.remove('hidden');
      return;
    }

    // ‚úîÔ∏è AUTORIZA√á√ÉO CONCEDIDA
    localStorage.setItem('lumina_access_type', 'full');
    localStorage.setItem('lumina_token', token);
    localStorage.setItem('lumina_nome', tokens[token].nome || 'Estudante Lumina');

    // üîÅ Vai para o ritual
    window.location.href = './splash.html';

  } catch (e) {
    console.error(e);
    alert('Erro ao validar acesso. Verifique os arquivos do portal.');
  }
}
</script>

</body>
</html>
